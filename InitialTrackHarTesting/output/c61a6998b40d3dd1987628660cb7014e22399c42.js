class OnboardingFlowModal{constructor(){let n=0,t=null,o=!1,a=!0,r=new Event("onboardingFinished"),s=this,i={declineOnBoardingProcessBtn:"js_decline-btn",acceptOnBoardingProcessBtn:"js_goToOnboardingModal",backToCustomizeBtn:"js_backToCustomizeBtn",welcomeModalPopUp:"welcome-onboardinModal",exitConfirmModalPopUp:"exit-onboardingModal",onboardingStepsModalPopUp:"steps-onboardingModal",completedOnboardingModalPopUp:"completed-onboardingModal",stepOne:"stepOne",closeModalBtn:".js_closeModalBtn",stepModal:"stepsModal",nextButton:".js_nextStep",stepOneBtn:"js_stepOneBtn",stepTwoBtn:"js_stepTwoBtn",prevButton:".js_backToPrevStep",nextButtonInactive:".inactive-btn",doneAllStepsBtn:"js_doneAllSteps",closeAllModalsBtn:".js_closeAllModals",subscribeBtn:".js_subscribeBtn",selectAllPill:".selectAll-pill",modalBackgroundOverlay:".modalBackgroundOverlay",country:document.getElementById("js_country"),emailVerificationBanner:document.querySelector(".js-emailBannerOnboarding"),changeUserNameInput:document.getElementById("js_changeYourUserNameInput"),responseMsgWrapper:document.getElementById("js_responseMsg"),userProfileDataUserName:document.querySelector(".js_userName"),exitOnboardingConfirmBtn:"js_confirmExitBtn",today:new Date};s.init=function(){s.initGtmEvent("quiz_start"),s.attachEvents(),document.getElementById(i.stepTwoBtn)&&s.showEthnicityAndCategory("women"),userClogTracking(currentDomain,"onb-flow",originPart,originUrl,clickedElement,"")},s.gtmHandleButtons=e=>{var t=document.getElementById(i.exitOnboardingConfirmBtn),n=document.getElementById(i.backToCustomizeBtn);document.querySelector("."+i.onboardingStepsModalPopUp).classList.contains("is-hidden")||(t.dataset.label="abandon_yes_"+(e+1),n.dataset.label="abandon_continue_"+(e+1))},s.initGtmEvent=function(e){window.dataLayer.push({event:"welcome_quiz",event_label:e})},s.attachEvents=function(){window.addEventListener("beforeunload",e=>{if(o)return e.preventDefault(),e.returnValue=!0}),document.getElementById(i.declineOnBoardingProcessBtn).addEventListener("click",e=>{s.openExitConfirmationPopup(),userClogTracking(currentDomain,"onb-flow-abandon",originPart,originUrl,"later","")}),document.getElementById(i.acceptOnBoardingProcessBtn).addEventListener("click",e=>{s.openStepsPopUpModals(),userClogTracking(currentDomain,"onb-flow-proceed",originPart,originUrl,"lets-do-it","")}),document.querySelectorAll(i.closeModalBtn).forEach(e=>{e.addEventListener("click",e=>{s.openExitConfirmationPopup(),userClogTracking(currentDomain,"onb-flow-abandon",originPart,originUrl,"button-close-x","")})}),document.querySelectorAll(i.modalBackgroundOverlay).forEach(e=>{let t="";e.addEventListener("mousedown",e=>{e=e.target||e.srcElement;e.classList.contains("modalBackgroundOverlay")&&(s.openExitConfirmationPopup(),t=e.classList.contains("is-hidden")&&!e.classList.contains("welcome-onboardinModal")?"quit_outside_modal_"+(n+1):e.classList.contains("completed-onboardingModal")?"quit_outside_modal_complete":"quit_outside_modal_"+n,s.initGtmEvent(t),userClogTracking(currentDomain,"onb-flow-abandon",originPart,originUrl,"outside_modal_window","")),e.classList.contains("completed-onboardingModal")&&s.completedCloseAllModals()})}),document.getElementById(i.backToCustomizeBtn).addEventListener("click",e=>{s.openStepsPopUpModals()}),document.getElementById(i.exitOnboardingConfirmBtn).addEventListener("click",()=>{s.abandonOnboardingAjaxCall(),userClogTracking(currentDomain,"onb-flow-confirm-abandon",originPart,originUrl,"yes",""),document.dispatchEvent(r)}),document.querySelectorAll(i.nextButton).forEach(t=>{t.addEventListener("click",e=>{t.classList.contains("disabled-nextBtn")||t.classList.contains("inactive-btn")||s.nextBtn()})}),document.getElementById(i.stepOneBtn).addEventListener("click",e=>{document.querySelector(i.nextButtonInactive)?s.initGtmEvent("step_1_next_error"):(userClogTracking(currentDomain,"onb-flow-basic-info-1",originPart,originUrl,"next-step",""),s.stepOneAjaxCall())}),document.getElementById(i.stepTwoBtn)&&document.getElementById(i.stepTwoBtn).addEventListener("click",e=>{s.stepTwoAjaxCall()}),document.querySelectorAll(i.subscribeBtn).forEach(e=>{e.addEventListener("click",e=>{var e=e.target,t=e.parentNode.classList.contains("buttonSubscribe")?e.parentNode.getAttribute("data-subscribe-url"):e.parentNode.getAttribute("data-unsubscribe-url"),n={type:e.parentNode.getAttribute("data-type"),id:e.parentNode.getAttribute("data-id")};s.stepThreeAjaxCall(t,n,e)})}),document.querySelectorAll(i.prevButton).forEach(e=>{e.addEventListener("click",e=>{s.prevBtn()})}),document.getElementById(i.doneAllStepsBtn).addEventListener("click",e=>{s.initGtmEvent("quiz_complete"),s.completeOnboardingAjaxCall(),s.openCompletedOnboardingPopUp(),userClogTracking(currentDomain,"onb-flow-sub",originPart,originUrl,"done","")}),document.querySelectorAll(i.closeAllModalsBtn).forEach(e=>{e.addEventListener("click",e=>{s.completedCloseAllModals(),document.dispatchEvent(r)})}),document.getElementById(i.stepTwoBtn)&&(document.getElementById("preference_women").addEventListener("click",e=>{s.showEthnicityAndCategory("women")}),document.getElementById("preference_men").addEventListener("click",e=>{s.showEthnicityAndCategory("men")}),document.getElementById("preference_trans").addEventListener("click",e=>{s.showEthnicityAndCategory("trans")}),document.querySelector(".interestedToWrapper").addEventListener("change",e=>{e=e.target;t!==e&&(s.clearCheckBoxes(),t=e)}),document.querySelectorAll(i.selectAllPill).forEach(e=>{e.addEventListener("click",e=>{var e=e.target,t=e.parentNode.getAttribute("data-id");s.checkAllEthnicities(e,t)})})),document.getElementById("js_changeYourUserName")&&(i.changeUserNameInput.addEventListener("input",()=>{s.changeUserNameAjaxCall()}),i.changeUserNameInput.addEventListener("blur",()=>{currentDeviceType&&"isMobileDevice"===currentDeviceType&&setTimeout(function(){window.scrollTo({top:0,behavior:"smooth"})},0)}))},s.openExitConfirmationPopup=()=>{s.gtmHandleButtons(n),document.querySelector("."+i.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.exitConfirmModalPopUp).classList.remove("is-hidden"),document.querySelector("."+i.onboardingStepsModalPopUp).classList.add("is-hidden"),o=!1,s.adjustEmailBannerPosition(!0,i.exitConfirmModalPopUp,0)},s.openStepsPopUpModals=()=>{document.querySelector("."+i.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.exitConfirmModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.onboardingStepsModalPopUp).classList.remove("is-hidden"),s.updateStepDisplay(n),o=!0},s.adjustEmailBannerPosition=(e,t,n)=>{var o;i.emailVerificationBanner&&((o=i.emailVerificationBanner).style.top="0px",o.classList.remove("behindModal"),e)&&t&&void 0!==n&&(e=(t=(e=document.querySelector("."+t))&&e.children[n]).offsetTop-(o.offsetHeight+o.offsetTop),t.offsetTop<o.offsetHeight?o.classList.add("behindModal"):e<0&&(o.style.top=e+"px"))},s.openCompletedOnboardingPopUp=()=>{document.querySelector("."+i.completedOnboardingModalPopUp).classList.remove("is-hidden"),document.querySelector("."+i.onboardingStepsModalPopUp).classList.add("is-hidden"),o=!1},s.updateStepDisplay=n=>{document.querySelectorAll("."+i.stepModal).forEach((e,t)=>{e.style.display=t===n?"block":"none"}),s.adjustEmailBannerPosition(!0,i.onboardingStepsModalPopUp,n)},s.nextBtn=()=>{n<document.querySelectorAll("."+i.stepModal).length-1&&(n++,s.updateStepDisplay(n))},s.prevBtn=()=>{0<n&&(n--,s.updateStepDisplay(n))},s.stepOneAjaxCall=()=>{var e={country:i.country.value||"",username:i.changeUserNameInput&&i.changeUserNameInput.value?i.changeUserNameInput.value:"",token:token};fetch("/onboarding/stepOne",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(()=>{i.changeUserNameInput&&currentUserName!==i.changeUserNameInput.value&&(i.changeUserNameInput.disabled=!0,i.responseMsgWrapper.innerHTML=userNameChangeMsg,i.responseMsgWrapper.classList.add("unavailableUserName"),i.responseMsgWrapper.classList.remove("availableUserName"),i.userProfileDataUserName.innerHTML=i.changeUserNameInput.value)})},s.stepTwoAjaxCall=()=>{var e=document.querySelector('input[name="preference"]:checked').value.toLowerCase(),t=Array.from(document.querySelectorAll('input[name="ethnicities[]"]:checked')).map(e=>e.value),n=Array.from(document.querySelectorAll('input[name="categories[]"]:checked')).map(e=>e.value),e={preference:e,ethnicities:JSON.stringify(t),categories:JSON.stringify(n),token:token};fetch("/onboarding/stepTwo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json())},s.stepThreeAjaxCall=(e,t,n)=>{fetch(e,{method:"POST",headers:{"Content-Type":"application/json",..."undefined"!=typeof liuIdOrNull&&liuIdOrNull?{__m:liuIdOrNull}:{}},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{"buttonUnsubscribe"===e.class?(n.parentNode.classList.add("buttonUnsubscribe"),n.parentNode.classList.remove("buttonSubscribe"),n.classList.remove("ph-icon-add-box"),n.classList.add("ph-icon-check-square")):(n.parentNode.classList.add("buttonSubscribe"),n.parentNode.classList.remove("buttonUnsubscribe"),n.classList.remove("ph-icon-check-square"),n.classList.add("ph-icon-add-box"))})},s.completeOnboardingAjaxCall=()=>{var e={token:token};fetch("/onboarding/completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>(e.ok||console.log("Network response was not ok"),e.json()))},s.abandonOnboardingAjaxCall=()=>{var e={token:token};fetch("/onboarding/abandoned",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")})},s.completedCloseAllModals=()=>{document.querySelector("."+i.welcomeModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.exitConfirmModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.onboardingStepsModalPopUp).classList.add("is-hidden"),document.querySelector("."+i.completedOnboardingModalPopUp).classList.add("is-hidden"),document.body.style.overflow="revert-layer",document.getElementById("header")&&(document.getElementById("header").style.zIndex="2",document.getElementById("headerMenuContainer").style.zIndex="3"),o=!1,s.adjustEmailBannerPosition(!1);var e=document.querySelector(".emailVerHomepageContainer");e&&e.classList.remove("onboarding")},document.getElementById(i.stepTwoBtn)&&(s.showEthnicityAndCategory=e=>{document.querySelectorAll(".ethnicity-wrapper, .category-wrapper").forEach(e=>{e.style.display="none"}),document.getElementById("ethnicity-"+e).style.display="block",document.getElementById("category-"+e).style.display="block"},s.clearCheckBoxes=()=>{document.querySelectorAll(".js_ethnicitySwitch, .js_categoriesSwitch").forEach(e=>{e.checked=!1})},s.checkAllEthnicities=(t,e)=>{document.querySelectorAll(".js_ethnicitySwitch-"+e).forEach(e=>{t.checked?e.checked=!0:e.checked=!1,e.addEventListener("click",()=>{t.checked=!1})})}),s.showSubscriptionsRow=e=>{document.querySelectorAll(".subscription-wrapper").forEach(e=>{e.style.display="none"});var t=currentDeviceType&&"isDesktopDevice"===currentDeviceType?"block":"flex";document.getElementById("subscription-"+e).style.display=t},s.changeUserNameAjaxCall=()=>{var e={username:i.changeUserNameInput.value,token:token};fetch("/onboarding/checkUserName",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>(e.ok||console.log("Network response was not ok"),e.json())).then(e=>{i.changeUserNameInput.classList.add("ajaxChangeUserNameInput"),i.responseMsgWrapper.classList.remove("is-hidden"),!0===e.status?(i.responseMsgWrapper.innerHTML=e.message,i.responseMsgWrapper.classList.add("availableUserName"),i.responseMsgWrapper.classList.remove("unavailableUserName"),a=!0,document.getElementById(i.stepOneBtn).classList.remove("inactive-btn")):(i.responseMsgWrapper.innerHTML=e.error,i.responseMsgWrapper.classList.add("unavailableUserName"),i.responseMsgWrapper.classList.remove("availableUserName"),document.getElementById(i.stepOneBtn).classList.add("inactive-btn"),a=!1)})}}}if(document.getElementById("onboardingInformation")){document.body.style.overflow="hidden",document.getElementById("header")&&(document.getElementById("header").style.zIndex="0",document.getElementById("headerMenuContainer").style.zIndex="0");try{(onboardingModalFlow=new OnboardingFlowModal).init()}catch(e){console.log(e)}let e=document.querySelectorAll(".js_mobileContainer");"undefined"!=typeof MG_Scroll&&MG_Scroll.init({width:"auto",selector:e,height:"100%",color:"#FF9000",size:"3px",alwaysVisible:!0,railVisible:!0,railOpacity:1,railColor:"transparent",distance:"2px",opacity:1,railClass:"track3",barClass:"handle3",wrapperClass:"wrapper3",wheelStep:5,enLargeOnHover:!0,enLargedSize:"4px"})}