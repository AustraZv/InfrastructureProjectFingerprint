"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.base64Regex = exports.base64Encodings = void 0;
const buffer_1 = require("buffer/");
/**
 * @param input The string or other data that you want to search for.
 * @returns An array of all possible base64 encodings of `input`.
 */
const base64Encodings = (input) => {
    // Inspired by: https://www.leeholmes.com/searching-for-content-in-base-64-strings/
    const buffer = buffer_1.Buffer.isBuffer(input) ? input : buffer_1.Buffer.from(input);
    return [
        buffer.toString('base64'),
        buffer_1.Buffer.concat([buffer_1.Buffer.alloc(1), buffer])
            .toString('base64')
            .substring(2),
        buffer_1.Buffer.concat([buffer_1.Buffer.alloc(2), buffer])
            .toString('base64')
            .substring(4),
    ].map((e) => e.replace(/.==?$/, ''));
};
exports.base64Encodings = base64Encodings;
/**
 * @param input The string or other data that you want to search for.
 * @returns A regex that matches all possible base64 encodings of `input` in a single capture group.
 */
const base64Regex = (input) => {
    const encodings = exports.base64Encodings(input);
    return `(${encodings.sort().join('|')})`;
};
exports.base64Regex = base64Regex;
