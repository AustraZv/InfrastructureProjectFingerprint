!function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(t){this.foundVideoPlayers=[],this.SearchForNewVideoPlayersInterval=5e3,this.newVideoFoundCallback=t,this.startSearching=function(){this.trackVideos(),this.listenForEXCOEvents()},this.trackVideos=function(){this.searchForVideosInWindow(window);var e=window.document.getElementsByTagName("iframe"),t=this;function n(e){var n=!1;try{n=e.contentWindow}catch(i){return}n&&t.searchForVideosInWindow(e.contentWindow)}for(var i=0;i<e.length;i++)n(e[i]);setTimeout((function(){t.trackVideos()}),this.SearchForNewVideoPlayersInterval)},this.searchForVideosInWindow=function(e){try{e.jwplayer}catch(t){return}this.searchForFlowPlayerPlayersInWindow(e),this.searchForJWPlayerPlayersInWindow(e),this.searchForVideoJSPlayersInWindow(e),this.searchForGreenVideoPlayersInWindow(e),this.searchForHearstVideoPlayersInWindow(e)},this.searchForFlowPlayerPlayersInWindow=function(e){if(e.flowplayer){var t=[],n=0;if(void 0===e.flowplayer.instances)return;for(e.flowplayer.instances.forEach((function(e){t.push(e)})),n=0;n<t.length;n++)this.foundVideoPlayers.indexOf(t[n])<0&&(this.foundVideoPlayers.push(t[n]),this.newVideoFoundCallback("flowPlayer",e.flowplayer.version,t[n]))}},this.searchForJWPlayerPlayersInWindow=function(e){if(e.jwplayer){var t=[],n=e.jwplayer.version;for(i=0;e.jwplayer(i)&&e.jwplayer(i).id;)t.push(e.jwplayer(i)),i++;for(var i=0;i<t.length;i++){for(var o=!0,r=0;r<this.foundVideoPlayers.length;r++)this.foundVideoPlayers[r].id&&this.foundVideoPlayers[r].id==t[i].id&&(o=!1);o&&(this.foundVideoPlayers.push(t[i]),this.newVideoFoundCallback("jwPlayer",t[i].version?t[i].version:n,t[i]))}}},this.searchForVideoJSPlayersInWindow=function(t){if(t.videojs&&"object"==e(t.videojs.players))for(var n in t.videojs.players){var i=t.videojs.players[n];i&&this.foundVideoPlayers.indexOf(i)<0&&(this.foundVideoPlayers.push(i),this.newVideoFoundCallback("videojs",t.videojs.VERSION,i))}},this.searchForGreenVideoPlayersInWindow=function(e){var t=this;window.customElements&&"function"==typeof window.customElements.whenDefined&&window.customElements.whenDefined("green-video").then((function(){var e=document.querySelector("green-video");e&&!e.dotmetricsPluginRegistered&&e.data&&(e.dotmetricsPluginRegistered=!0,t.newVideoFoundCallback("green-video",1,e))}))},this.searchForHearstVideoPlayersInWindow=function(e){if(e.videoPlayerManager&&Array.isArray(e.videoPlayerManager.instances))for(var t=0;t<e.videoPlayerManager.instances.length;t++){var n=e.videoPlayerManager.instances[t];n&&this.foundVideoPlayers.indexOf(n)<0&&(this.foundVideoPlayers.push(n),this.newVideoFoundCallback("hearst-video",1,n))}},this.manuallyAddVideoPlayerInstance=function(t,n){if(t&&"object"===e(t)){if("flowPlayer"===n){if(!this.validateFPInstance(t))throw new Error("Invalid FlowPlayer instance")}else if("jwPlayer"===n){if(!this._validateJWPlayerInstance(t))throw new Error("Invalid jwPlayer instance")}else if("videojs"===n){if(!this._validateVideoJSInstance(t))throw new Error("Invalid videojs player instance")}else{if("green-video"!==n)throw new Error("Invalid video player type");if(!this._validateGreenVideoInstance(t))throw new Error("Invalid green-video player instance")}for(var i=0;i<this.foundVideoPlayers.length;i++)if(this.foundVideoPlayers[i]===t)return!1;return this.foundVideoPlayers.push(t),this.newVideoFoundCallback(n,null,t),!0}},this.validateFPInstance=function(t){if(!t||"object"!==e(t))return!1;for(var n=0,i=["currentSrc","duration","currentTime","videoWidth","videoHeight","opts","playerState"];n<i.length;n++){if(!(i[n]in t))return!1}if("string"!=typeof t.currentSrc||"number"!=typeof t.duration||"number"!=typeof t.currentTime||"number"!=typeof t.videoWidth||"number"!=typeof t.videoHeight||"object"!==e(t.opts)||"object"!==e(t.playerState))return!1;for(var o=0,r=["on","off"];o<r.length;o++){if("function"!=typeof t[r[o]])return!1}return!0},this._validateJWPlayerInstance=function(t){if(!t||"object"!==e(t))return!1;for(var n=0,i=["getPlaylistItem","getWidth","getHeight","getDuration","getPosition","on","off"];n<i.length;n++){if("function"!=typeof t[i[n]])return!1}return"function"==typeof t.on||"function"==typeof t.onPlay&&"function"==typeof t.onSeek&&"function"==typeof t.onTime},this._validateVideoJSInstance=function(t){if(!t||"object"!==e(t))return!1;for(var n=0,i=["currentSrc","duration","currentTime","on","off","seeking"];n<i.length;n++){if("function"!=typeof t[i[n]])return!1}var o="function"==typeof t.videoWidth||"function"==typeof t.width,r="function"==typeof t.videoHeight||"function"==typeof t.height;return!(!o||!r)},this._validateGreenVideoInstance=function(t){if(!t||"object"!==e(t))return!1;for(var n=["ad","config","data","plugin","tracking","ui","vendor","video"],i=0;i<n.length;i++)if(!t[n[i]])return!1;return"object"===e(t.ad)&&"object"===e(t.config)&&"object"===e(t.data)&&"object"===e(t.plugin)&&"object"===e(t.tracking)&&"object"===e(t.ui)&&"object"===e(t.vendor)&&"object"===e(t.video)&&"function"==typeof t.plugin.register},this.listenForEXCOEvents=function(){var e=this;window.addEventListener("message",(function t(n){"exco-event"===n.data.type&&(window.removeEventListener("message",t),e.newVideoFoundCallback("exco",1,null))}))}}var n=new function(){this.SettingsObject=window.DotMetricsSettings,this.SettingsObject.NCSHitUrl="/unconsentedvideohit.gif",this.baseUrlPrefix=this.SettingsObject.BaseUrl,this._sentVideoUrls=[],this.videoPlayerSearch=null,this.Start=function(){var e=this;this.videoPlayerSearch=new t((function(t,n,i){switch(t){case"flowPlayer":e.trackFP(i);break;case"jwPlayer":e.trackJW(i);break;case"videojs":e.trackVideoJS(i);break;case"green-video":e.trackGreenVideo(i);break;case"exco":e.trackExco()}})),1==this.SettingsObject.VideoSearchEnabled&&this.videoPlayerSearch.startSearching()},this.AddVideoPlayer=function(e,t){if(null!=this.videoPlayerSearch)try{return this.videoPlayerSearch.manuallyAddVideoPlayerInstance(e,t)}catch(n){throw n}},this.sendData=function(e){if(!(this._sentVideoUrls.indexOf(e)>=0)){var t=this.SettingsObject.SiteSectionId,n=window.location.hostname,i=encodeURIComponent(window.location),o=this.SettingsObject.EventChainId,r=(new Date).getTimezoneOffset(),a=this.baseUrlPrefix+this.SettingsObject.NCSHitUrl+"?videoUrl="+e+"&id="+t+"&dom="+n+"&url="+i+"&ecid="+o+"&tzOffset="+r+"&ver="+this.SettingsObject.ScriptVersion;(new Image).src=a,this._sentVideoUrls.push(e)}},this.trackFP=function(e){var t=this;e.on("playing",(function(n){t.sendData(e.currentSrc)}))},this.trackJW=function(e){var t=this;e.on("play",(function(n){var i=e.getPlaylistItem();void 0!==i&&t.sendData(i.file)}))},this.trackVideoJS=function(e){var t=this;e.on("play",(function(){t.sendData(e.currentSrc())}))},this.AddVideoPlayer=function(e,t){if(null!=this.videoPlayerSearch)try{return this.videoPlayerSearch.manuallyAddVideoPlayerInstance(e,t)}catch(n){throw n}},this.trackGreenVideo=function(e){var t=this;try{e.plugin.register("pluginVendorMiddleware",(function(e,n){if("video/PLAY"===e.type)i=n(),t.sendData(i.video.sources[0].src);var i}))}catch(n){}},this.trackExco=function(){var e=this,t=!1;window.addEventListener("message",(function(n){"exco-event"===n.data.type&&function(n){switch(n.name){case"content-start":e.sendData(n.metadata.src);break;case"content-time":t||(e.sendData(n.metadata.src),t=!0)}}(n.data)}))}};window.DotMetricsObj={AddVideoPlayer:function(e,t){return n.AddVideoPlayer(e,t)}},top.location==self.location&&setTimeout((function(){n.Start()}),100)}();
//# sourceMappingURL=ncs-script.js.map
